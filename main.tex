\documentclass[landscape,a4paper]{article}
\usepackage[margin=1.5cm]{geometry}
\usepackage{tikz}
\usepackage{rubikcube,rubikrotation,rubikpatterns}
\usepackage{multicol}
\usepackage{xstring}
\pagestyle{headings}
%\pagestyle{empty}
\overfullrule=5mm
\usepackage{wrapfig}
\usepackage{ifthen}
\usepackage{luacode}

\begin{luacode*}
	function sanitize_rubik_sequence(sequence)
		fix_2p,_ = string.gsub(sequence, "2p", "2")
		fix_wide,_ = string.gsub(fix_2p, "[rufldb]", function(s)
			return string.upper(s) .. "w"
		end)
		fix_3,_ = string.gsub(fix_wide, "3", "p")
		tex.print(fix_3)
	end
\end{luacode*}

\begin{luacode*}
	function select_oll(param)
		if param == "oll" then
			tex.print('\\RubikCubeGreyAll\\RubikFaceDownAll{Y}')
		else
			tex.print('\\RubikCubeSolved')
		end
	end
\end{luacode*}

\newcommand{\formatRubikSequence}[1]{
\StrSubstitute{#1}{,}{ }[\rubiktmp]%
\StrSubstitute{\rubiktmp}{p}{'}[\rubiktmp]%
\rubiktmp
}

% #1: oll?
% #2: name of the algorithm
% #3: sequence
\newcommand{\alg}[4][]{
	\directlua{select_oll("#1")}
	\RubikRotation{x2,yp}%
	\RubikRotation{[#2],\directlua{sanitize_rubik_sequence("#3")},<inverse>}%
	\noindent\ShowCube{2cm}{0.45}{\DrawRubikFaceUpSide}%
	\hspace{0.2cm}
	\begin{minipage}{10cm}
		\textbf{#2:}\formatRubikSequence{#3}

		#4
	\end{minipage}
	\vspace{0.2cm}
}

\begin{document}
\begin{center}
	{\Huge{\textbf{2LLL (2 Look Last Layer)}}}
\end{center}
\begin{multicols}{2}
\input{ocll.tex}
\input{pll.tex}
\end{multicols}

\end{document}
